# –ú–∏–≥—Ä–∞—Ü–∏—è Custom ID –Ω–∞ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç

## –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç custom_id –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π:
- **–°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç**: `12345678` (8 —Å–ª—É—á–∞–π–Ω—ã—Ö —Ü–∏—Ñ—Ä)
- **–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç**: `023-455` (XXX-XXX, 6 —Ü–∏—Ñ—Ä —Å —Ç–∏—Ä–µ)

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞

‚úÖ **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –§–æ—Ä–º–∞—Ç XXX-XXX –ª–µ–≥—á–µ —á–∏—Ç–∞—Ç—å –∏ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å  
‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: 1,000,000 –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π (000-000 –¥–æ 999-999)  
‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —á–µ—Ä–µ–∑ regex  
‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**: –ö–æ—Ä–æ—á–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤  

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. –ù–æ–≤—ã–π –º–æ–¥—É–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID

–°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `app/utils/id_generator.py` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:

```python
from app.utils.id_generator import generate_custom_id, is_valid_custom_id

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ ID
new_id = generate_custom_id()  # ‚Üí "023-455"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
is_valid = is_valid_custom_id("023-455")  # ‚Üí True
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **`app/utils/announcement_processor.py`**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
- **`app/commands/getauto.py`**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥
- **`get_auto.py`**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–¢–µ—Å—Ç—ã**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç

### 3. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–°—Ç–∞—Ä—ã–µ ID –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è:
```python
from app.utils.id_generator import convert_old_id_to_new_format

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å—Ç–∞—Ä–æ–≥–æ ID
old_id = "12345678"
new_id = convert_old_id_to_new_format(old_id)  # ‚Üí "345-678"
```

## –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Ç–∏–ª–∏—Ç—É `app/utils/migrate_custom_ids.py`:

```bash
# –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
python3 app/utils/migrate_custom_ids.py

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
```

### –ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏

1. **–ê–Ω–∞–ª–∏–∑**: –°–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –≤ –±–∞–∑–µ
2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: 
   - ‚úÖ –£–∂–µ –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
   - üîÑ –¢—Ä–µ–±—É—é—Ç –º–∏–≥—Ä–∞—Ü–∏–∏  
   - ‚ö†Ô∏è –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã (–∫–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID)
3. **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏
4. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª—è–µ—Ç ID –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
5. **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤**: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üîÑ –£—Ç–∏–ª–∏—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ Custom ID
==================================================
üîç –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
üìä –ù–∞–π–¥–µ–Ω–æ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –≤ –±–∞–∑–µ: 150
‚úÖ –£–∂–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ: 20
üîÑ –¢—Ä–µ–±—É—é—Ç –º–∏–≥—Ä–∞—Ü–∏–∏: 125
‚ö†Ô∏è  –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤: 5

üìã –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏: 125 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
üîç –ü—Ä–∏–º–µ—Ä—ã –º–∏–≥—Ä–∞—Ü–∏–∏:
  1. 12345678 ‚Üí 345-678
  2. 87654321 ‚Üí 654-321
  3. 11223344 ‚Üí 223-344
  ... –∏ –µ—â–µ 122

‚ùì –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 125 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π? (y/N):
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID –¥–ª—è –Ω–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π

```python
from app.utils.id_generator import generate_custom_id

# –í announcement_processor.py
custom_id = generate_custom_id()  # "567-890"
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö ID

```python
from app.utils.id_generator import is_valid_custom_id

def process_car_id(custom_id: str):
    if not is_valid_custom_id(custom_id):
        raise ValueError(f"–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID: {custom_id}")
    # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É...
```

### –ü–æ–∏—Å–∫ ID –≤ —Ç–µ–∫—Å—Ç–µ

```python
from app.utils.id_generator import extract_custom_id_from_text

text = "–ê–≤—Ç–æ–º–æ–±–∏–ª—å 123-456 –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø–æ–∫—É–ø–∫–∏"
found_id = extract_custom_id_from_text(text)  # ‚Üí "123-456"
```

### –ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ

```python
from app.utils.id_generator import format_id_for_display

display_text = format_id_for_display("123-456")  # ‚Üí "üÜî 123-456"
```

## API –∏–∑–º–µ–Ω–µ–Ω–∏—è

### Cloudinary

–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –≤ –∏–º–µ–Ω–∞—Ö —Ñ–∞–π–ª–æ–≤:
- **–ë—ã–ª–æ**: `car_12345678_1`
- **–°—Ç–∞–ª–æ**: `car_023-455_1`

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ–ª–µ `custom_id` —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–æ—Ä–º–∞—Ç XXX-XXX:
```json
{
  "custom_id": "023-455",
  "brand": "BMW",
  "model": "X5"
}
```

### Telegram –∫–æ–º–∞–Ω–¥—ã

–û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥:
- **–ë—ã–ª–æ**: `/getauto 12345678`
- **–°—Ç–∞–ª–æ**: `/getauto 023-455`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

### –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –æ—Ç–∫–∞—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ backup –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
node app/db/backup_script.js

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
node app/db/restore_script.js backup_file.sql
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. ‚úÖ –í—Å–µ ID –≤ —Ñ–æ—Ä–º–∞—Ç–µ XXX-XXX
2. ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö ID
3. ‚úÖ Cloudinary URLs –æ–±–Ω–æ–≤–ª–µ–Ω—ã
4. ‚úÖ –ü–æ–∏—Å–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```python
from app.utils.id_generator import get_id_statistics

stats = get_id_statistics()
print(f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ ID: {stats['used_count']}")
print(f"–û—Å—Ç–∞–µ—Ç—Å—è: {stats['remaining']}")
```

## Troubleshooting

### –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç ID –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏  
**–†–µ—à–µ–Ω–∏–µ**: –£—Ç–∏–ª–∏—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID

**–ü—Ä–æ–±–ª–µ–º–∞**: –°—Ç–∞—Ä—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç  
**–†–µ—à–µ–Ω–∏–µ**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é

**–ü—Ä–æ–±–ª–µ–º–∞**: Cloudinary –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã  
**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç–µ public_id –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º

### –ö–æ–º–∞–Ω–¥—ã –æ—Ç–ª–∞–¥–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ ID
python3 -c "
from app.utils.id_generator import is_valid_custom_id
print(is_valid_custom_id('023-455'))  # True
print(is_valid_custom_id('12345678'))  # False
"

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
python3 app/utils/id_generator.py

# –ê–Ω–∞–ª–∏–∑ –±–∞–∑—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
python3 app/utils/migrate_custom_ids.py
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç custom_id –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –õ—É—á—à–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç
- –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é
- –£–ø—Ä–æ—â–µ–Ω–Ω—É—é –æ—Ç–ª–∞–¥–∫—É
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ä–∏—Å–∫–∞–º–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–æ—à–∞–≥–æ–≤–æ–º—É –ø–æ–¥—Ö–æ–¥—É –∏ —Ñ—É–Ω–∫—Ü–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. 